name: CI

on:
  workflow_call:
    secrets:
      REGISTRY_USERNAME:
        required: true
      REGISTRY_TOKEN:
        required: true
        
env:
  REGISTRY: ghcr.io

jobs:
  docker:
    name: Build and push Docker image
    runs-on: ubuntu-cloud-runner
    timeout-minutes: 60

    steps:
      - name: Print repository name
        run: echo "RepositoryName:${{ github.repository }}"
        
      - name: GITHUB_REPOSITORY
        run: echo "RepositoryName:${{ GITHUB_REPOSITORY }}"

      - name: GITHUB_REF_TYPE
        run: echo "${{GITHUB_REF_TYPE}}"

      - name: GITHUB_SHA
        run: echo "${{GITHUB_SHA}}"
      # - name: Checkout repository
      #   uses: actions/checkout@v4

      # - name: Login to GitHub Container Registry
      #   uses: docker/login-action@v3
      #   with:
      #     registry: ${{ env.REGISTRY }}
      #     username: ${{ secrets.REGISTRY_USERNAME }}
      #     password: ${{ secrets.REGISTRY_TOKEN  }}

      # - name: Set up Docker Buildx
      #   uses: docker/setup-buildx-action@v3

      # - name: Build and push
      #   uses: docker/build-push-action@v6
      #   with:
      #     context: .
      #     file: ./docker/Dockerfile
      #     push: true
      #     tags: ${{ env.REGISTRY }}/${{ github.repository }}:latest
      #     cache-from: type=registry,ref=${{ env.REGISTRY }}/${{ github.repository }}:buildcache
      #     cache-to: type=registry,ref=${{ env.REGISTRY }}/${{ github.repository }}:buildcache,mode=max 